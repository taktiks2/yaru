# Rustã§å­¦ã¶ãƒ‰ãƒ¡ã‚¤ãƒ³é§†å‹•è¨­è¨ˆï¼ˆDDDï¼‰ã¨ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

yaruã‚¿ã‚¹ã‚¯ç®¡ç†ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®å®Ÿè£…ã‹ã‚‰ç†è§£ã™ã‚‹ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã®åŸºæœ¬

---

## ã¯ã˜ã‚ã«

ã“ã‚“ã«ã¡ã¯ï¼ä»Šå›ã¯ã€Rustè£½ã®ã‚¿ã‚¹ã‚¯ç®¡ç†CLIã‚¢ãƒ—ãƒªã€Œyaruã€ã®å®Ÿè£…ã‚’é€šã˜ã¦ã€**ãƒ‰ãƒ¡ã‚¤ãƒ³é§†å‹•è¨­è¨ˆï¼ˆDDDï¼‰**ã¨**ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£**ã«ã¤ã„ã¦ã€åˆå¿ƒè€…ã®æ–¹ã«ã‚‚åˆ†ã‹ã‚Šã‚„ã™ãè§£èª¬ã—ã¦ã„ãã¾ã™ã€‚

yaruã¯ã€TUIãƒ¢ãƒ¼ãƒ‰ï¼ˆå¯¾è©±çš„ãªã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ï¼‰ã¨CLIãƒ¢ãƒ¼ãƒ‰ï¼ˆã‚³ãƒãƒ³ãƒ‰ãƒ©ã‚¤ãƒ³å¼•æ•°ï¼‰ã®ä¸¡æ–¹ã‚’ã‚µãƒãƒ¼ãƒˆã™ã‚‹ã‚¿ã‚¹ã‚¯ç®¡ç†ã‚¢ãƒ—ãƒªã§ã™ãŒã€ãã®å†…éƒ¨æ§‹é€ ã¯éå¸¸ã«æ´—ç·´ã•ã‚ŒãŸã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã§è¨­è¨ˆã•ã‚Œã¦ã„ã¾ã™ã€‚

**ã“ã®è¨˜äº‹ã§ã‚ã‹ã‚‹ã“ã¨ï¼š**
- ãƒ‰ãƒ¡ã‚¤ãƒ³é§†å‹•è¨­è¨ˆï¼ˆDDDï¼‰ã®åŸºæœ¬æ¦‚å¿µ
- ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã®ãƒ¬ã‚¤ãƒ¤ãƒ¼æ§‹é€ 
- ä¾å­˜æ€§é€†è»¢ã®åŸå‰‡ï¼ˆDIPï¼‰ã®å®Ÿè·µæ–¹æ³•
- Rustã§ã®å®Ÿè£…ä¾‹

---

## 1. ãƒ‰ãƒ¡ã‚¤ãƒ³é§†å‹•è¨­è¨ˆï¼ˆDDDï¼‰ã¨ã¯ï¼Ÿ

**ãƒ‰ãƒ¡ã‚¤ãƒ³é§†å‹•è¨­è¨ˆï¼ˆDomain-Driven Design, DDDï¼‰**ã¯ã€ã‚¨ãƒªãƒƒã‚¯ãƒ»ã‚¨ãƒ´ã‚¡ãƒ³ã‚¹ãŒæå”±ã—ãŸã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢è¨­è¨ˆã®æ‰‹æ³•ã§ã™ã€‚

### DDDã®æ ¸å¿ƒçš„ãªè€ƒãˆæ–¹

1. **ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯ã‚’ä¸­å¿ƒã«è¨­è¨ˆã™ã‚‹**
   - ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚„UIã‹ã‚‰è€ƒãˆã‚‹ã®ã§ã¯ãªãã€ã€Œãƒ“ã‚¸ãƒã‚¹ä¸Šã®å•é¡Œã‚’ã©ã†è§£æ±ºã™ã‚‹ã‹ã€ã‹ã‚‰è¨­è¨ˆã‚’ã‚¹ã‚¿ãƒ¼ãƒˆã—ã¾ã™

2. **ãƒ‰ãƒ¡ã‚¤ãƒ³ãƒ¢ãƒ‡ãƒ«ã‚’é‡è¦–ã™ã‚‹**
   - ãƒ“ã‚¸ãƒã‚¹ä¸Šã®æ¦‚å¿µï¼ˆãƒ‰ãƒ¡ã‚¤ãƒ³ï¼‰ã‚’ã‚³ãƒ¼ãƒ‰ã§è¡¨ç¾ã—ã¾ã™
   - ä¾‹ï¼šã‚¿ã‚¹ã‚¯ç®¡ç†ã‚¢ãƒ—ãƒªãªã‚‰ã€Œã‚¿ã‚¹ã‚¯ã€ã€Œã‚¿ã‚°ã€ã€Œã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã€ã€Œå„ªå…ˆåº¦ã€ãªã©ãŒãƒ‰ãƒ¡ã‚¤ãƒ³ã®æ¦‚å¿µã§ã™

3. **å…±é€šè¨€èªï¼ˆãƒ¦ãƒ“ã‚­ã‚¿ã‚¹è¨€èªï¼‰ã‚’ä½¿ã†**
   - é–‹ç™ºè€…ã¨ãƒ“ã‚¸ãƒã‚¹å´ã§åŒã˜è¨€è‘‰ã‚’ä½¿ã„ã€ã‚³ãƒ¼ãƒ‰ã«ã‚‚ãã®è¨€è‘‰ã‚’åæ˜ ã—ã¾ã™

### DDDã®ä¸»è¦ãªãƒ‘ã‚¿ãƒ¼ãƒ³

yaruã§ä½¿ç”¨ã—ã¦ã„ã‚‹ä¸»è¦ãªDDDãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’ç´¹ä»‹ã—ã¾ã™ï¼š

#### â‘  é›†ç´„ãƒ«ãƒ¼ãƒˆï¼ˆAggregate Rootï¼‰

ãƒ“ã‚¸ãƒã‚¹ä¸Šã®é‡è¦ãªæ¦‚å¿µã‚’ã¾ã¨ã‚ã‚‹ã€Œå…¥å£ã€ã¨ãªã‚‹ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã§ã™ã€‚

```rust
/// TaskAggregate - ã‚¿ã‚¹ã‚¯ã®Aggregate Root
///
/// ã‚¿ã‚¹ã‚¯ã®ãƒ“ã‚¸ãƒã‚¹ãƒ«ãƒ¼ãƒ«ã‚’å®Ÿè£…ã—ã€ä¸å¤‰æ¡ä»¶ã‚’ä¿è­·ã—ã¾ã™ã€‚
#[derive(Debug)]
pub struct TaskAggregate {
    id: TaskId,
    title: TaskTitle,
    description: TaskDescription,
    status: Status,
    priority: Priority,
    tags: Vec<TagId>,
    created_at: DateTime<Utc>,
    updated_at: DateTime<Utc>,
    due_date: Option<DueDate>,
    completed_at: Option<DateTime<Utc>>,
    domain_events: Vec<Box<dyn Any + Send + Sync>>,
}
```

**ãƒã‚¤ãƒ³ãƒˆï¼š**

- `TaskAggregate`ãŒã‚¿ã‚¹ã‚¯ã«é–¢ã™ã‚‹å…¨ã¦ã®æƒ…å ±ã‚’ç®¡ç†
- å¤–éƒ¨ã‹ã‚‰ç›´æ¥ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚’å¤‰æ›´ã§ããªã„ï¼ˆprivateãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ï¼‰
- ãƒ“ã‚¸ãƒã‚¹ãƒ«ãƒ¼ãƒ«ã‚’å®ˆã‚‹ãƒ¡ã‚½ãƒƒãƒ‰ã®ã¿ã‚’å…¬é–‹

#### â‘¡ å€¤ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆï¼ˆValue Objectï¼‰

ãƒ‰ãƒ¡ã‚¤ãƒ³ã®æ¦‚å¿µã‚’è¡¨ã™ã€ä¸å¤‰ã§äº¤æ›å¯èƒ½ãªã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã§ã™ã€‚

```rust
/// ã‚¿ã‚¹ã‚¯ã®ã‚¿ã‚¤ãƒˆãƒ«ã‚’è¡¨ã™Value Object
///
/// ã‚¿ã‚¤ãƒˆãƒ«ã¯1æ–‡å­—ä»¥ä¸Š100æ–‡å­—ä»¥ä¸‹ã®æ–‡å­—åˆ—ã§ã‚ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚
#[derive(Debug, Clone, PartialEq, Eq)]
pub struct TaskTitle(String);

impl TaskTitle {
    /// æ–°ã—ã„TaskTitleã‚’ä½œæˆ
    pub fn new(value: impl Into<String>) -> Result<Self> {
        let value = value.into();

        if value.trim().is_empty() {
            anyhow::bail!("ã‚¿ã‚¤ãƒˆãƒ«ã¯ç©ºã«ã§ãã¾ã›ã‚“");
        }

        if value.len() > 100 {
            anyhow::bail!("ã‚¿ã‚¤ãƒˆãƒ«ã¯100æ–‡å­—ä»¥å†…ã«ã—ã¦ãã ã•ã„");
        }

        Ok(Self(value))
    }

    /// ã‚¿ã‚¤ãƒˆãƒ«ã®å€¤ã‚’å–å¾—
    pub fn value(&self) -> &str {
        &self.0
    }
}
```

**ãƒã‚¤ãƒ³ãƒˆï¼š**
- **Newtypeãƒ‘ã‚¿ãƒ¼ãƒ³**ã‚’ä½¿ç”¨ï¼ˆ`TaskTitle(String)`ï¼‰
- ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ï¼ˆ`new`ãƒ¡ã‚½ãƒƒãƒ‰ï¼‰ã§**ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³**ã‚’å®Ÿæ–½
- ä¸æ­£ãªå€¤ã§`TaskTitle`ã‚’ä½œã‚‹ã“ã¨ãŒã§ããªã„ä»•çµ„ã¿
- ãƒ“ã‚¸ãƒã‚¹ãƒ«ãƒ¼ãƒ«ï¼ˆã€Œã‚¿ã‚¤ãƒˆãƒ«ã¯ç©ºã«ã§ããªã„ã€ã€Œ100æ–‡å­—ä»¥å†…ã€ï¼‰ãŒã‚³ãƒ¼ãƒ‰ã«æ˜ç¤ºçš„ã«è¡¨ç¾ã•ã‚Œã¦ã„ã‚‹

#### â‘¢ ãƒªãƒã‚¸ãƒˆãƒªãƒ‘ã‚¿ãƒ¼ãƒ³ï¼ˆRepository Patternï¼‰

ãƒ‡ãƒ¼ã‚¿ã®æ°¸ç¶šåŒ–ã‚’æŠ½è±¡åŒ–ã™ã‚‹ãƒ‘ã‚¿ãƒ¼ãƒ³ã§ã™ã€‚

```rust
/// TaskRepository trait - ã‚¿ã‚¹ã‚¯ã®æ°¸ç¶šåŒ–ã‚’æŠ½è±¡åŒ–
///
/// DIPï¼ˆä¾å­˜æ€§é€†è»¢ã®åŸå‰‡ï¼‰ã«å¾“ã„ã€ãƒ‰ãƒ¡ã‚¤ãƒ³å±¤ã«Repository traitã‚’å®šç¾©ã—ã¾ã™ã€‚
/// å®Ÿè£…ã¯Interfaceå±¤ï¼ˆsrc/interface/persistence/ï¼‰ã§è¡Œã„ã¾ã™ã€‚
#[async_trait::async_trait]
pub trait TaskRepository: Send + Sync {
    /// IDã§ã‚¿ã‚¹ã‚¯ã‚’æ¤œç´¢
    async fn find_by_id(&self, id: &TaskId) -> Result<Option<TaskAggregate>>;

    /// å…¨ã‚¿ã‚¹ã‚¯ã‚’å–å¾—
    async fn find_all(&self) -> Result<Vec<TaskAggregate>>;

    /// æ–°ã—ã„ã‚¿ã‚¹ã‚¯ã‚’ä¿å­˜
    async fn save(&self, task: TaskAggregate) -> Result<TaskAggregate>;

    /// æ—¢å­˜ã®ã‚¿ã‚¹ã‚¯ã‚’æ›´æ–°
    async fn update(&self, task: TaskAggregate) -> Result<TaskAggregate>;

    /// IDã§ã‚¿ã‚¹ã‚¯ã‚’å‰Šé™¤
    async fn delete(&self, id: &TaskId) -> Result<bool>;
}
```

**ãƒã‚¤ãƒ³ãƒˆï¼š**
- **ãƒˆãƒ¬ã‚¤ãƒˆï¼ˆtraitï¼‰**ã¨ã—ã¦å®šç¾©ã•ã‚Œã¦ãŠã‚Šã€å…·ä½“çš„ãªå®Ÿè£…ã¯å«ã¾ã‚Œã¦ã„ãªã„
- ãƒ‰ãƒ¡ã‚¤ãƒ³å±¤ã¯ã€Œä½•ãŒã§ãã‚‹ã‹ã€ã ã‘ã‚’å®šç¾©ã—ã€ã€Œã©ã†ã‚„ã£ã¦å®Ÿç¾ã™ã‚‹ã‹ã€ã¯çŸ¥ã‚‰ãªã„
- ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãŒSQLiteã§ã‚‚PostgreSQLã§ã‚‚ã€ã‚ã‚‹ã„ã¯ãƒ¡ãƒ¢ãƒªå†…ã§ã‚‚ã€åŒã˜ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã§æ‰±ãˆã‚‹

---

## 2. ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã¨ã¯ï¼Ÿ

**ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£**ã¯ã€ãƒ­ãƒãƒ¼ãƒˆãƒ»Cãƒ»ãƒãƒ¼ãƒãƒ³ï¼ˆUncle Bobï¼‰ãŒæå”±ã—ãŸã€ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ã‚’è¤‡æ•°ã®å±¤ã«åˆ†é›¢ã™ã‚‹è¨­è¨ˆæ‰‹æ³•ã§ã™ã€‚

### yaruã«ãŠã‘ã‚‹4ã¤ã®å±¤

yaruã¯ä»¥ä¸‹ã®4å±¤æ§‹é€ ã§è¨­è¨ˆã•ã‚Œã¦ã„ã¾ã™ï¼š

```
src/
â”œâ”€â”€ domain/          # 1. ãƒ‰ãƒ¡ã‚¤ãƒ³å±¤ï¼ˆãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯ï¼‰
â”‚   â”œâ”€â”€ task/        # ã‚¿ã‚¹ã‚¯é›†ç´„ãƒ«ãƒ¼ãƒˆã€å€¤ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã€ãƒªãƒã‚¸ãƒˆãƒªã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹
â”‚   â”œâ”€â”€ tag/         # ã‚¿ã‚°é›†ç´„ãƒ«ãƒ¼ãƒˆã€ãƒªãƒã‚¸ãƒˆãƒªã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹
â”‚   â””â”€â”€ services/    # ãƒ‰ãƒ¡ã‚¤ãƒ³ã‚µãƒ¼ãƒ“ã‚¹
â”‚
â”œâ”€â”€ application/     # 2. ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³å±¤ï¼ˆãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹ï¼‰
â”‚   â”œâ”€â”€ use_cases/   # ã‚¿ã‚¹ã‚¯ãƒ»ã‚¿ã‚°ã®ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹å®Ÿè£…
â”‚   â””â”€â”€ dto/         # ãƒ‡ãƒ¼ã‚¿è»¢é€ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ
â”‚
â”œâ”€â”€ infrastructure/  # 3. ã‚¤ãƒ³ãƒ•ãƒ©ã‚¹ãƒˆãƒ©ã‚¯ãƒãƒ£å±¤
â”‚   â”œâ”€â”€ database/    # SeaORMã«ã‚ˆã‚‹DBæ¥ç¶šç®¡ç†
â”‚   â””â”€â”€ config/      # è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ç®¡ç†
â”‚
â””â”€â”€ interface/       # 4. ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹å±¤
    â”œâ”€â”€ cli/         # CLIã‚³ãƒãƒ³ãƒ‰ãƒãƒ³ãƒ‰ãƒ©ï¼ˆclapï¼‰
    â”œâ”€â”€ tui/         # TUIã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ï¼ˆratatuiï¼‰
    â””â”€â”€ persistence/ # ãƒªãƒã‚¸ãƒˆãƒªå®Ÿè£…ï¼ˆSeaORM, in-memoryï¼‰
```

### ä¾å­˜é–¢ä¿‚ã®æ–¹å‘

é‡è¦ãªã®ã¯ã€**ä¾å­˜é–¢ä¿‚ã®æ–¹å‘**ã§ã™ï¼š

```
interface â”€â”€â†’ application â”€â”€â†’ domain
     â†‘                           â†‘
infrastructure â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

- **ãƒ‰ãƒ¡ã‚¤ãƒ³å±¤**ã¯ã€ä»–ã®ã©ã®å±¤ã«ã‚‚ä¾å­˜ã—ãªã„ï¼ˆæœ€ã‚‚å†…å´ï¼‰
- **ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³å±¤**ã¯ã€ãƒ‰ãƒ¡ã‚¤ãƒ³å±¤ã®ã¿ã«ä¾å­˜
- **ã‚¤ãƒ³ãƒ•ãƒ©ã‚¹ãƒˆãƒ©ã‚¯ãƒãƒ£å±¤**ã¨**ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹å±¤**ã¯ã€ãƒ‰ãƒ¡ã‚¤ãƒ³å±¤ã«ä¾å­˜
- **ã‚¤ãƒ³ãƒ•ãƒ©ã‚¹ãƒˆãƒ©ã‚¯ãƒãƒ£å±¤**ã¨**ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹å±¤**ã¯ã€ãŠäº’ã„ã«ä¾å­˜ã—ãªã„

ã“ã®æ§‹é€ ã«ã‚ˆã‚Šã€ä»¥ä¸‹ã®ãƒ¡ãƒªãƒƒãƒˆãŒã‚ã‚Šã¾ã™ï¼š

âœ… **ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯ãŒå¤–éƒ¨ã®è©³ç´°ã‹ã‚‰ç‹¬ç«‹**
   - DBã‚’å¤‰æ›´ã—ã¦ã‚‚ã€UIã‚’å¤‰æ›´ã—ã¦ã‚‚ã€ãƒ‰ãƒ¡ã‚¤ãƒ³å±¤ã«ã¯å½±éŸ¿ãŒãªã„

âœ… **ãƒ†ã‚¹ãƒˆãŒå®¹æ˜“**
   - ãƒ‰ãƒ¡ã‚¤ãƒ³å±¤ã¯DBã‚„UIãªã—ã§ãƒ†ã‚¹ãƒˆå¯èƒ½

âœ… **ä¿å®ˆæ€§ãŒé«˜ã„**
   - å¤‰æ›´ã®å½±éŸ¿ç¯„å›²ãŒæ˜ç¢º

---

## 3. å„å±¤ã®å½¹å‰²ã¨å®Ÿè£…ä¾‹

### 3.1 ãƒ‰ãƒ¡ã‚¤ãƒ³å±¤ï¼ˆDomain Layerï¼‰

**å½¹å‰²ï¼š**
- ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯ã¨ãƒ«ãƒ¼ãƒ«ã‚’å®Ÿè£…
- å¤–éƒ¨ã®æŠ€è¡“çš„è©³ç´°ï¼ˆDBã€UIç­‰ï¼‰ã«ã¯ä¸€åˆ‡ä¾å­˜ã—ãªã„

**å«ã¾ã‚Œã‚‹ã‚‚ã®ï¼š**
- é›†ç´„ãƒ«ãƒ¼ãƒˆï¼ˆAggregate Rootï¼‰
- å€¤ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆï¼ˆValue Objectï¼‰
- ãƒ‰ãƒ¡ã‚¤ãƒ³ã‚¤ãƒ™ãƒ³ãƒˆï¼ˆDomain Eventï¼‰
- ãƒªãƒã‚¸ãƒˆãƒªã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ï¼ˆRepository Interfaceï¼‰
- ãƒ‰ãƒ¡ã‚¤ãƒ³ã‚µãƒ¼ãƒ“ã‚¹ï¼ˆDomain Serviceï¼‰

**å®Ÿè£…ä¾‹ï¼šã‚¿ã‚¹ã‚¯ã‚’å®Œäº†ã™ã‚‹ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯**

```rust
impl TaskAggregate {
    /// ã‚¿ã‚¹ã‚¯ã‚’å®Œäº†ã—ã¾ã™
    ///
    /// ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚’Completedã«å¤‰æ›´ã—ã€completed_atã‚’ç¾åœ¨æ™‚åˆ»ã«è¨­å®šã—ã¾ã™ã€‚
    /// æ—¢ã«å®Œäº†ã—ã¦ã„ã‚‹å ´åˆã¯ã€ä½•ã‚‚ã—ã¾ã›ã‚“ã€‚
    pub fn complete(&mut self) -> Result<()> {
        if self.status != Status::Completed {
            self.status = Status::Completed;
            let now = Utc::now();
            self.completed_at = Some(now);
            self.updated_at = now;

            // Domain Eventç™ºè¡Œ
            let event = TaskCompleted::new(self.id, now);
            self.domain_events.push(Box::new(event));
        }
        Ok(())
    }

    /// ã‚¿ã‚¹ã‚¯ãŒæœŸé™åˆ‡ã‚Œã‹ã©ã†ã‹ã‚’åˆ¤å®šã—ã¾ã™
    pub fn is_overdue(&self) -> bool {
        if self.status == Status::Completed {
            return false;
        }

        if let Some(due_date) = &self.due_date {
            let today = Utc::now().naive_utc().date();
            return due_date.value() < today;
        }

        false
    }
}
```

**ãƒã‚¤ãƒ³ãƒˆï¼š**
- `complete()`ãƒ¡ã‚½ãƒƒãƒ‰ã¯ã€ã‚¿ã‚¹ã‚¯ã‚’å®Œäº†ã™ã‚‹éš›ã®ãƒ“ã‚¸ãƒã‚¹ãƒ«ãƒ¼ãƒ«ã‚’å®Ÿè£…
- æ—¢ã«å®Œäº†ã—ã¦ã„ã‚‹å ´åˆã¯ä½•ã‚‚ã—ãªã„ï¼ˆå†ªç­‰æ€§ï¼‰
- ãƒ‰ãƒ¡ã‚¤ãƒ³ã‚¤ãƒ™ãƒ³ãƒˆã‚’ç™ºè¡Œã—ã¦ã€ä»–ã®å‡¦ç†ã¨é€£æºã§ãã‚‹ã‚ˆã†ã«ã—ã¦ã„ã‚‹
- ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚„UIã®ã“ã¨ã¯ä¸€åˆ‡è€ƒãˆã¦ã„ãªã„

### 3.2 ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³å±¤ï¼ˆApplication Layerï¼‰

**å½¹å‰²ï¼š**
- ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹ï¼ˆã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®æ©Ÿèƒ½ï¼‰ã‚’å®Ÿè£…
- ãƒ‰ãƒ¡ã‚¤ãƒ³å±¤ã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’çµ„ã¿åˆã‚ã›ã¦ã€ãƒ“ã‚¸ãƒã‚¹ãƒ—ãƒ­ã‚»ã‚¹ã‚’å®Ÿç¾
- DTO(Data Transfer Object)ã‚’ä½¿ã£ã¦å¤–éƒ¨ã¨ã®å…¥å‡ºåŠ›ã‚’åˆ¶å¾¡

**å®Ÿè£…ä¾‹ï¼šã‚¿ã‚¹ã‚¯è¿½åŠ ã®ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹**

```rust
/// AddTaskUseCase - ã‚¿ã‚¹ã‚¯è¿½åŠ ã®ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹
///
/// æ–°ã—ã„ã‚¿ã‚¹ã‚¯ã‚’ä½œæˆã—ã¦ãƒªãƒã‚¸ãƒˆãƒªã«ä¿å­˜ã—ã¾ã™ã€‚
pub struct AddTaskUseCase {
    task_repository: Arc<dyn TaskRepository>,
    tag_repository: Arc<dyn TagRepository>,
}

impl AddTaskUseCase {
    pub fn new(
        task_repository: Arc<dyn TaskRepository>,
        tag_repository: Arc<dyn TagRepository>,
    ) -> Self {
        Self {
            task_repository,
            tag_repository,
        }
    }

    /// ã‚¿ã‚¹ã‚¯ã‚’è¿½åŠ ã™ã‚‹
    pub async fn execute(&self, dto: CreateTaskDTO) -> Result<TaskDTO> {
        // 1. ã‚¿ã‚¤ãƒˆãƒ«ã®ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³
        let title = TaskTitle::new(dto.title)?;

        // 2. èª¬æ˜ã®ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³
        let description = if let Some(desc) = dto.description {
            TaskDescription::new(desc)?
        } else {
            TaskDescription::new("")?
        };

        // 3. ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã®å¤‰æ›ï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ: Pendingï¼‰
        let status = if let Some(status_str) = dto.status {
            Status::from_str(&status_str)
                .or_else(|_| Status::from_filter_value(&status_str))?
        } else {
            Status::Pending
        };

        // 4. å„ªå…ˆåº¦ã®å¤‰æ›ï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ: Mediumï¼‰
        let priority = if let Some(priority_str) = dto.priority {
            parse_priority(&priority_str)?
        } else {
            Priority::Medium
        };

        // 5. ã‚¿ã‚°ã®å­˜åœ¨ç¢ºèª
        for tag_id in &dto.tags {
            let tag_id_vo = TagId::new(*tag_id)?;
            if self.tag_repository.find_by_id(&tag_id_vo).await?.is_none() {
                bail!("ã‚¿ã‚°ID {}ã¯å­˜åœ¨ã—ã¾ã›ã‚“", tag_id);
            }
        }

        // 6. ã‚¿ã‚°IDã®Value Objectã«å¤‰æ›
        let tag_ids: Result<Vec<_>> = dto
            .tags
            .iter()
            .map(|id| TagId::new(*id))
            .collect();
        let tag_ids = tag_ids?;

        // 7. TaskAggregateã‚’ä½œæˆ
        let task = TaskAggregate::new(
            title,
            description,
            status,
            priority,
            tag_ids,
            due_date,
        );

        // 8. ãƒªãƒã‚¸ãƒˆãƒªã«ä¿å­˜
        let saved_task = self.task_repository.save(task).await?;

        // 9. DTOã«å¤‰æ›ã—ã¦è¿”ã™
        Ok(TaskDTO::from(saved_task))
    }
}
```

**ãƒã‚¤ãƒ³ãƒˆï¼š**
- DTOã§å¤–éƒ¨ã‹ã‚‰å—ã‘å–ã£ãŸãƒ‡ãƒ¼ã‚¿ã‚’ã€ãƒ‰ãƒ¡ã‚¤ãƒ³ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã«å¤‰æ›
- ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã‚’å®Ÿæ–½ï¼ˆã‚¿ã‚°ã®å­˜åœ¨ç¢ºèªãªã©ï¼‰
- ãƒ‰ãƒ¡ã‚¤ãƒ³ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½¿ã£ã¦ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯ã‚’å®Ÿè¡Œ
- ãƒªãƒã‚¸ãƒˆãƒªã‚’ä½¿ã£ã¦ãƒ‡ãƒ¼ã‚¿ã‚’æ°¸ç¶šåŒ–
- çµæœã‚’DTOã«å¤‰æ›ã—ã¦è¿”ã™ï¼ˆãƒ‰ãƒ¡ã‚¤ãƒ³ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’å¤–éƒ¨ã«å…¬é–‹ã—ãªã„ï¼‰

### 3.3 ã‚¤ãƒ³ãƒ•ãƒ©ã‚¹ãƒˆãƒ©ã‚¯ãƒãƒ£å±¤ï¼ˆInfrastructure Layerï¼‰

**å½¹å‰²ï¼š**
- ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ¥ç¶šã®ç®¡ç†
- è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã®èª­ã¿è¾¼ã¿
- å¤–éƒ¨ã‚µãƒ¼ãƒ“ã‚¹ã¨ã®é€£æº

**yaruã§ã®å®Ÿè£…ï¼š**
- SeaORMã‚’ä½¿ã£ãŸãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ¥ç¶šç®¡ç†
- TOMLãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰ã®è¨­å®šèª­ã¿è¾¼ã¿

ã“ã®å±¤ã¯æŠ€è¡“çš„ãªè©³ç´°ã«ç‰¹åŒ–ã—ã¦ãŠã‚Šã€ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯ã¯å«ã¾ã‚Œã¾ã›ã‚“ã€‚

### 3.4 ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹å±¤ï¼ˆInterface Layerï¼‰

**å½¹å‰²ï¼š**
- å¤–éƒ¨ã¨ã®ã‚„ã‚Šå–ã‚Šã‚’æ‹…å½“
- CLIã€TUIã€APIãªã©ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¨ã®æ¥ç‚¹
- ãƒªãƒã‚¸ãƒˆãƒªã®å…·ä½“çš„ãªå®Ÿè£…

**å®Ÿè£…ä¾‹1ï¼šãƒªãƒã‚¸ãƒˆãƒªã®å®Ÿè£…ï¼ˆSeaORMï¼‰**

```rust
/// SeaORMå®Ÿè£…ã®TaskRepository
pub struct SeaOrmTaskRepository {
    db: DatabaseConnection,
}

#[async_trait]
impl TaskRepository for SeaOrmTaskRepository {
    async fn find_by_id(&self, id: &TaskId) -> Result<Option<TaskAggregate>> {
        let task_model = Tasks::find_by_id(id.value()).one(&self.db).await?;

        match task_model {
            Some(model) => {
                let tag_ids = self.get_tag_ids(model.id).await?;
                let aggregate = TaskMapper::to_domain(model, tag_ids)?;
                Ok(Some(aggregate))
            }
            None => Ok(None),
        }
    }

    async fn save(&self, task: TaskAggregate) -> Result<TaskAggregate> {
        // æ–°è¦ä½œæˆ
        let active_model = TaskMapper::to_active_model_for_insert(&task);
        let saved_model = active_model.insert(&self.db).await?;

        // ã‚¿ã‚°ã®é–¢é€£ä»˜ã‘ã‚’ä¿å­˜
        let tag_ids: Vec<i32> = task.tags()
            .iter()
            .map(|tag_id| tag_id.value())
            .collect();
        self.update_task_tags(saved_model.id, &tag_ids).await?;

        // ä¿å­˜ã•ã‚ŒãŸã‚¿ã‚¹ã‚¯ã‚’å–å¾—ã—ã¦è¿”ã™
        let tag_ids = self.get_tag_ids(saved_model.id).await?;
        TaskMapper::to_domain(saved_model, tag_ids)?
    }

    // ... ä»–ã®ãƒ¡ã‚½ãƒƒãƒ‰
}
```

**ãƒã‚¤ãƒ³ãƒˆï¼š**
- ãƒ‰ãƒ¡ã‚¤ãƒ³å±¤ã§å®šç¾©ã—ãŸ`TaskRepository`ãƒˆãƒ¬ã‚¤ãƒˆã‚’å®Ÿè£…
- SQLiteã‚’ä½¿ã£ãŸå…·ä½“çš„ãªæ°¸ç¶šåŒ–ãƒ­ã‚¸ãƒƒã‚¯
- ãƒ‰ãƒ¡ã‚¤ãƒ³ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆï¼ˆ`TaskAggregate`ï¼‰ã¨ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãƒ¢ãƒ‡ãƒ«ã‚’ç›¸äº’å¤‰æ›ï¼ˆ`TaskMapper`ï¼‰

**å®Ÿè£…ä¾‹2ï¼šCLIãƒãƒ³ãƒ‰ãƒ©**

```rust
/// ã‚¿ã‚¹ã‚¯ã‚³ãƒãƒ³ãƒ‰ã‚’å‡¦ç†
pub async fn handle_task_command(
    command: TaskCommands,
    task_repo: Arc<dyn TaskRepository>,
    tag_repo: Arc<dyn TagRepository>,
) -> Result<()> {
    match command {
        TaskCommands::Add {
            title,
            description,
            status,
            priority,
            tags,
            due_date,
        } => {
            // DTOã‚’æ§‹ç¯‰
            let dto = CreateTaskDTO {
                title: final_title,
                description: Some(final_description),
                status: Some(final_status.to_string()),
                priority: Some(final_priority.to_string()),
                tags: final_tags,
                due_date: final_due_date,
            };

            // Use Caseã‚’å®Ÿè¡Œ
            let use_case = AddTaskUseCase::new(task_repo, tag_repo);
            let created_task = use_case.execute(dto).await?;

            println!(
                "ã‚¿ã‚¹ã‚¯ã‚’è¿½åŠ ã—ã¾ã—ãŸ: [{}] {}",
                created_task.id, created_task.title
            );

            Ok(())
        }
        // ... ä»–ã®ã‚³ãƒãƒ³ãƒ‰
    }
}
```

**ãƒã‚¤ãƒ³ãƒˆï¼š**
- ã‚³ãƒãƒ³ãƒ‰ãƒ©ã‚¤ãƒ³å¼•æ•°ã‚’å—ã‘å–ã‚Šã€DTOã«å¤‰æ›
- ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹ã‚’å‘¼ã³å‡ºã—
- çµæœã‚’ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«è¡¨ç¤º

---

## 4. ä¾å­˜æ€§é€†è»¢ã®åŸå‰‡ï¼ˆDIPï¼‰ã®å®Ÿè·µ

ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã®æœ€ã‚‚é‡è¦ãªåŸå‰‡ã®ä¸€ã¤ãŒã€**ä¾å­˜æ€§é€†è»¢ã®åŸå‰‡ï¼ˆDependency Inversion Principle, DIPï¼‰**ã§ã™ã€‚

### å¾“æ¥ã®ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã®å•é¡Œç‚¹

å¾“æ¥ã®ãƒ¬ã‚¤ãƒ¤ãƒ¼ãƒ‰ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã§ã¯ã€ä»¥ä¸‹ã®ã‚ˆã†ãªä¾å­˜é–¢ä¿‚ã§ã—ãŸï¼š

```
UIå±¤ â†’ ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯å±¤ â†’ ãƒ‡ãƒ¼ã‚¿ã‚¢ã‚¯ã‚»ã‚¹å±¤ â†’ ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹
```

ã“ã®å ´åˆã€ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯ãŒãƒ‡ãƒ¼ã‚¿ã‚¢ã‚¯ã‚»ã‚¹å±¤ï¼ˆå…·ä½“çš„ãªå®Ÿè£…ï¼‰ã«ä¾å­˜ã—ã¦ã—ã¾ã„ã€ä»¥ä¸‹ã®å•é¡ŒãŒç™ºç”Ÿã—ã¾ã™ï¼š

âŒ ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚’å¤‰æ›´ã™ã‚‹ã¨ã€ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯ã«ã‚‚å½±éŸ¿ãŒå‡ºã‚‹
âŒ ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãªã—ã§ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯ã‚’ãƒ†ã‚¹ãƒˆã§ããªã„
âŒ ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯ã®å†åˆ©ç”¨ãŒé›£ã—ã„

### DIPã«ã‚ˆã‚‹è§£æ±º

yaruã§ã¯ã€ä¾å­˜æ€§ã‚’é€†è»¢ã•ã›ã¦ã„ã¾ã™ï¼š

```
interface/persistence/sea_orm
          â†“ï¼ˆå®Ÿè£…ï¼‰
domain/task/repository (trait)
          â†‘ï¼ˆä¾å­˜ï¼‰
application/use_cases
```

**æ‰‹é †ï¼š**

1. **ãƒ‰ãƒ¡ã‚¤ãƒ³å±¤ã§ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ï¼ˆtraitï¼‰ã‚’å®šç¾©**
   ```rust
   // src/domain/task/repository.rs
   pub trait TaskRepository: Send + Sync {
       async fn save(&self, task: TaskAggregate) -> Result<TaskAggregate>;
       // ...
   }
   ```

2. **ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹å±¤ã§å…·ä½“çš„ã«å®Ÿè£…**
   ```rust
   // src/interface/persistence/sea_orm/task_repository.rs
   pub struct SeaOrmTaskRepository {
       db: DatabaseConnection,
   }

   impl TaskRepository for SeaOrmTaskRepository {
       async fn save(&self, task: TaskAggregate) -> Result<TaskAggregate> {
           // SQLiteã¸ã®ä¿å­˜å‡¦ç†
       }
   }
   ```

3. **ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³å±¤ã§ã¯traitã‚’ä½¿ç”¨**
   ```rust
   // src/application/use_cases/task/add_task.rs
   pub struct AddTaskUseCase {
       task_repository: Arc<dyn TaskRepository>, // traitçµŒç”±ã§ä½¿ç”¨
   }
   ```

**ãƒ¡ãƒªãƒƒãƒˆï¼š**

âœ… **ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯ãŒå…·ä½“çš„ãªå®Ÿè£…ã«ä¾å­˜ã—ãªã„**
   - SQLiteã‹ã‚‰PostgreSQLã«å¤‰æ›´ã—ã¦ã‚‚ã€ãƒ‰ãƒ¡ã‚¤ãƒ³å±¤ã¨ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³å±¤ã¯ç„¡å¤‰æ›´

âœ… **ãƒ†ã‚¹ãƒˆç”¨ã®å®Ÿè£…ã‚’ç°¡å˜ã«å·®ã—æ›¿ãˆã‚‰ã‚Œã‚‹**
   ```rust
   // ãƒ†ã‚¹ãƒˆç”¨ã®ãƒ¡ãƒ¢ãƒªå®Ÿè£…
   pub struct InMemoryTaskRepository {
       tasks: Arc<RwLock<HashMap<i32, TaskAggregate>>>,
   }

   impl TaskRepository for InMemoryTaskRepository {
       // ãƒ¡ãƒ¢ãƒªå†…ã§ã®ä¿å­˜å‡¦ç†
   }
   ```

âœ… **è¤‡æ•°ã®å®Ÿè£…ã‚’ä¸¦è¡Œã—ã¦ä½¿ç”¨ã§ãã‚‹**
   - æœ¬ç•ªç’°å¢ƒï¼šSeaOrmTaskRepository
   - ãƒ†ã‚¹ãƒˆç’°å¢ƒï¼šInMemoryTaskRepository
   - åŒã˜ã‚³ãƒ¼ãƒ‰ã§å‹•ä½œã™ã‚‹

---

## 5. å®Ÿéš›ã®å‹•ä½œãƒ•ãƒ­ãƒ¼

ã‚¿ã‚¹ã‚¯ã‚’è¿½åŠ ã™ã‚‹éš›ã®ã€å®Ÿéš›ã®ã‚³ãƒ¼ãƒ‰ã®æµã‚Œã‚’è¦‹ã¦ã¿ã¾ã—ã‚‡ã†ï¼š

```
1. ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒã‚³ãƒãƒ³ãƒ‰å®Ÿè¡Œ
   $ cargo run -- task add "è²·ã„ç‰©ã«è¡Œã"

2. CLIå±¤ãŒã‚³ãƒãƒ³ãƒ‰ã‚’è§£æ
   â†“ (interface/cli/task_handler.rs)

3. DTOã‚’ä½œæˆ
   CreateTaskDTO {
       title: "è²·ã„ç‰©ã«è¡Œã",
       description: None,
       status: None,
       priority: None,
       tags: vec![],
       due_date: None,
   }

4. ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹ã‚’å®Ÿè¡Œ
   â†“ (application/use_cases/task/add_task.rs)

5. ãƒ‰ãƒ¡ã‚¤ãƒ³ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½œæˆ
   TaskTitle::new("è²·ã„ç‰©ã«è¡Œã")?  // ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³å®Ÿè¡Œ
   â†“
   TaskAggregate::new(...)  // é›†ç´„ãƒ«ãƒ¼ãƒˆä½œæˆ

6. ãƒªãƒã‚¸ãƒˆãƒªã«ä¿å­˜
   task_repository.save(task).await?
   â†“ (interface/persistence/sea_orm/task_repository.rs)

7. SQLiteã«ä¿å­˜
   active_model.insert(&self.db).await?

8. çµæœã‚’DTOã«å¤‰æ›ã—ã¦è¿”ã™
   TaskDTO::from(saved_task)

9. CLIå±¤ã§çµæœã‚’è¡¨ç¤º
   println!("ã‚¿ã‚¹ã‚¯ã‚’è¿½åŠ ã—ã¾ã—ãŸ: [{}] {}", id, title);
```

ã“ã®æµã‚Œã§é‡è¦ãªã®ã¯ã€**å„å±¤ãŒè‡ªåˆ†ã®è²¬å‹™ã ã‘ã«é›†ä¸­ã—ã¦ã„ã‚‹**ã“ã¨ã§ã™ï¼š

- **CLIå±¤**ï¼šã‚³ãƒãƒ³ãƒ‰ã®è§£æã¨çµæœã®è¡¨ç¤º
- **ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³å±¤**ï¼šãƒ“ã‚¸ãƒã‚¹ãƒ—ãƒ­ã‚»ã‚¹ã®èª¿æ•´
- **ãƒ‰ãƒ¡ã‚¤ãƒ³å±¤**ï¼šãƒ“ã‚¸ãƒã‚¹ãƒ«ãƒ¼ãƒ«ã®å®Ÿè£…
- **ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹å±¤ï¼ˆãƒªãƒã‚¸ãƒˆãƒªå®Ÿè£…ï¼‰**ï¼šãƒ‡ãƒ¼ã‚¿ã®æ°¸ç¶šåŒ–

---

## 6. ãƒ†ã‚¹ãƒˆå®¹æ˜“æ€§ã®å®Ÿç¾

ã“ã®ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã®å¤§ããªãƒ¡ãƒªãƒƒãƒˆã®ä¸€ã¤ãŒã€**ãƒ†ã‚¹ãƒˆã®å®¹æ˜“æ€§**ã§ã™ã€‚

### ãƒ‰ãƒ¡ã‚¤ãƒ³å±¤ã®ãƒ†ã‚¹ãƒˆ

ãƒ‰ãƒ¡ã‚¤ãƒ³å±¤ã¯å¤–éƒ¨ã«ä¾å­˜ã—ãªã„ãŸã‚ã€ç´”ç²‹ãªå˜ä½“ãƒ†ã‚¹ãƒˆãŒå¯èƒ½ã§ã™ï¼š

```rust
#[test]
fn test_task_title_empty() {
    let result = TaskTitle::new("");
    assert!(result.is_err());
    assert!(result.unwrap_err().to_string().contains("ç©º"));
}

#[test]
fn test_complete_task() {
    let mut task = TaskAggregate::new(
        TaskTitle::new("ãƒ†ã‚¹ãƒˆã‚¿ã‚¹ã‚¯").unwrap(),
        TaskDescription::new("").unwrap(),
        Status::InProgress,
        Priority::High,
        vec![],
        None,
    );

    let result = task.complete();

    assert!(result.is_ok());
    assert_eq!(task.status(), &Status::Completed);
    assert!(task.completed_at().is_some());
}
```

### ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³å±¤ã®ãƒ†ã‚¹ãƒˆ

ãƒ¡ãƒ¢ãƒªå®Ÿè£…ã®ãƒªãƒã‚¸ãƒˆãƒªã‚’ä½¿ãˆã°ã€ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãªã—ã§ãƒ†ã‚¹ãƒˆã§ãã¾ã™ï¼š

```rust
#[tokio::test]
async fn test_add_task_minimal() {
    // ãƒ†ã‚¹ãƒˆç”¨ã®ãƒ¡ãƒ¢ãƒªãƒªãƒã‚¸ãƒˆãƒªã‚’ä½¿ç”¨
    let task_repo = Arc::new(InMemoryTaskRepository::new());
    let tag_repo = Arc::new(InMemoryTagRepository::new());
    let use_case = AddTaskUseCase::new(task_repo.clone(), tag_repo);

    let dto = CreateTaskDTO {
        title: "æ–°ã—ã„ã‚¿ã‚¹ã‚¯".to_string(),
        description: None,
        status: None,
        priority: None,
        tags: vec![],
        due_date: None,
    };

    let result = use_case.execute(dto).await;

    assert!(result.is_ok());
    let task = result.unwrap();
    assert_eq!(task.title, "æ–°ã—ã„ã‚¿ã‚¹ã‚¯");
}
```

**ãƒã‚¤ãƒ³ãƒˆï¼š**
- ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ãŒä¸è¦
- ãƒ†ã‚¹ãƒˆãŒé«˜é€Ÿ
- ãƒ†ã‚¹ãƒˆã®ç‹¬ç«‹æ€§ãŒä¿ãŸã‚Œã‚‹ï¼ˆä¸¦åˆ—å®Ÿè¡Œå¯èƒ½ï¼‰

---

## 7. ã¾ã¨ã‚

### DDDã¨ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã®ãƒ¡ãƒªãƒƒãƒˆ

âœ… **ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯ã®æ˜ç¢ºåŒ–**
   - ãƒ‰ãƒ¡ã‚¤ãƒ³å±¤ã‚’è¦‹ã‚Œã°ã€ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãŒä½•ã‚’ã™ã‚‹ã‚‚ã®ã‹ãŒåˆ†ã‹ã‚‹
   - ãƒ“ã‚¸ãƒã‚¹ãƒ«ãƒ¼ãƒ«ãŒã‚³ãƒ¼ãƒ‰ã«æ˜ç¤ºçš„ã«è¡¨ç¾ã•ã‚Œã¦ã„ã‚‹

âœ… **å¤‰æ›´ã«å¼·ã„**
   - UIã‚’å¤‰æ›´ã—ã¦ã‚‚ã€DBã‚’å¤‰æ›´ã—ã¦ã‚‚ã€ãƒ‰ãƒ¡ã‚¤ãƒ³å±¤ã«ã¯å½±éŸ¿ãŒãªã„
   - æŠ€è¡“çš„ãªè©³ç´°ã‚’ç°¡å˜ã«å·®ã—æ›¿ãˆã‚‰ã‚Œã‚‹

âœ… **ãƒ†ã‚¹ãƒˆãŒå®¹æ˜“**
   - å„å±¤ã‚’ç‹¬ç«‹ã—ã¦ãƒ†ã‚¹ãƒˆã§ãã‚‹
   - ãƒ¢ãƒƒã‚¯ã‚„ã‚¹ã‚¿ãƒ–ã‚’ç°¡å˜ã«ä½œæˆã§ãã‚‹

âœ… **ãƒãƒ¼ãƒ é–‹ç™ºãŒã—ã‚„ã™ã„**
   - å„å±¤ã®è²¬å‹™ãŒæ˜ç¢ºã§ã€ä¸¦è¡Œé–‹ç™ºãŒã—ã‚„ã™ã„
   - æ–°ã—ã„ãƒ¡ãƒ³ãƒãƒ¼ã‚‚ã‚³ãƒ¼ãƒ‰ã®æ§‹é€ ã‚’ç†è§£ã—ã‚„ã™ã„

### ãƒ‡ãƒ¡ãƒªãƒƒãƒˆãƒ»æ³¨æ„ç‚¹

âš ï¸ **åˆæœŸã‚³ã‚¹ãƒˆãŒé«˜ã„**
   - ã‚·ãƒ³ãƒ—ãƒ«ãªã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã«ã¯éå‰°è¨­è¨ˆã«ãªã‚‹å¯èƒ½æ€§
   - å­¦ç¿’ã‚³ã‚¹ãƒˆãŒå¿…è¦

âš ï¸ **ã‚³ãƒ¼ãƒ‰é‡ãŒå¢—ãˆã‚‹**
   - DTOã€Mapperã€è¤‡æ•°ã®å±¤ãªã©ã€ã‚³ãƒ¼ãƒ‰é‡ã¯å¢—åŠ å‚¾å‘

âš ï¸ **é©åˆ‡ãªå¢ƒç•Œã®è¨­å®šãŒé›£ã—ã„**
   - ã©ã“ã¾ã§ã‚’ãƒ‰ãƒ¡ã‚¤ãƒ³ã¨ã™ã‚‹ã‹ã€åˆ¤æ–­ãŒå¿…è¦

### ã©ã‚“ãªãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã«å‘ã„ã¦ã„ã‚‹ï¼Ÿ

ğŸ‘ **å‘ã„ã¦ã„ã‚‹ã‚±ãƒ¼ã‚¹ï¼š**
- ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯ãŒè¤‡é›‘ãªã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³
- é•·æœŸé‹ç”¨ãŒäºˆå®šã•ã‚Œã¦ã„ã‚‹ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ
- è¤‡æ•°äººã§ã®ãƒãƒ¼ãƒ é–‹ç™º
- æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯ã®å¤‰æ›´å¯èƒ½æ€§ãŒã‚ã‚‹

ğŸ‘ **å‘ã„ã¦ã„ãªã„ã‚±ãƒ¼ã‚¹ï¼š**
- ã‚·ãƒ³ãƒ—ãƒ«ãªCRUDã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³
- ä½¿ã„æ¨ã¦ã®ãƒ—ãƒ­ãƒˆã‚¿ã‚¤ãƒ—
- å€‹äººã®å°è¦æ¨¡ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ

---

## ãŠã‚ã‚Šã«

yaruãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’é€šã˜ã¦ã€DDDã¨ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã®åŸºæœ¬ã‚’ç´¹ä»‹ã—ã¾ã—ãŸã€‚

ã“ã®ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã¯ä¸€è¦‹è¤‡é›‘ã«è¦‹ãˆã¾ã™ãŒã€**ã€Œé–¢å¿ƒã®åˆ†é›¢ã€**ã¨ã„ã†æ˜ç¢ºãªåŸå‰‡ã«åŸºã¥ã„ã¦ã„ã¾ã™ã€‚å„å±¤ãŒè‡ªåˆ†ã®è²¬å‹™ã ã‘ã«é›†ä¸­ã™ã‚‹ã“ã¨ã§ã€çµæœã¨ã—ã¦ä¿å®ˆæ€§ã®é«˜ã„ã‚³ãƒ¼ãƒ‰ãƒ™ãƒ¼ã‚¹ãŒå®Ÿç¾ã•ã‚Œã¾ã™ã€‚

å®Ÿéš›ã®yaruã®ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã¯GitHubã§å…¬é–‹ã•ã‚Œã¦ã„ã¾ã™ã®ã§ã€ãœã²ã‚³ãƒ¼ãƒ‰ã‚’èª­ã‚“ã§ç†è§£ã‚’æ·±ã‚ã¦ã¿ã¦ãã ã•ã„ã€‚

**å‚è€ƒãƒªãƒ³ã‚¯ï¼š**
- [Eric Evans - Domain-Driven Design](https://www.domainlanguage.com/ddd/)
- [Robert C. Martin - Clean Architecture](https://blog.cleancoder.com/uncle-bob/2012/08/13/the-clean-architecture.html)
- [Rust by Example](https://doc.rust-lang.org/rust-by-example/)

Happy Coding! ğŸ¦€
